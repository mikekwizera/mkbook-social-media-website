import{b as V,c as b,i as w}from"./PostModal-DOhXdX-p.js";import{j as v,i as s,A,z as g,f as m,o as p,b as E,a as f,F as P,p as y,c as B}from"./app-ktTZm4lV.js";import{_ as I}from"./AttachmentPreviewModal-DcEB-VJa.js";const U={class:"overflow-auto"},L={__name:"PostList",props:{posts:Array},setup($){const n=v(),x=v().props.auth.user,u=s(!1),d=s(!1),i=s({}),l=s({}),c=s(null),o=s({data:[],next:null});A(()=>n.props.posts,()=>{var e;n.props.posts&&(o.value={data:n.props.posts.data,next:(e=n.props.posts.links)==null?void 0:e.next})},{deep:!0,immediate:!0});function _(e){i.value=e,u.value=!0}function h(e,t){l.value={post:e,index:t},d.value=!0}function M(){i.value={id:null,body:"",user:x}}function k(){o.value.next&&w.get(o.value.next).then(({data:e})=>{o.value.data=[...o.value.data,...e.data],o.value.next=e.links.next})}return g(()=>{new IntersectionObserver(t=>t.forEach(r=>r.isIntersecting&&k()),{rootMargin:"-250px 0px 0px 0px"}).observe(c.value)}),(e,t)=>{var r;return p(),m("div",U,[(p(!0),m(P,null,y(o.value.data,a=>(p(),B(V,{key:a.id,post:a,onEditClick:_,onAttachmentClick:h},null,8,["post"]))),128)),E("div",{ref_key:"loadMoreIntersect",ref:c},null,512),f(b,{post:i.value,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),onHide:M},null,8,["post","modelValue"]),f(I,{attachments:((r=l.value.post)==null?void 0:r.attachments)||[],index:l.value.index,"onUpdate:index":t[1]||(t[1]=a=>l.value.index=a),modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value=a)},null,8,["attachments","index","modelValue"])])}}};export{L as _};
